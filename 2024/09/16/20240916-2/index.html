<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>建模优化列车限制速度曲线 | 57D02's Home</title><meta name="author" content="57D02"><meta name="copyright" content="57D02"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="建模优化列车限制速度曲线场景假设​	假设列车在一段长 1500 米的试验线上运行。列车运行起点在 60 米处，运行方向沿着里程增加的方向运行。列车数据：列车最大牵引加速度为 1.7m&#x2F;s&#x2F;s，最大制动减速度为 1.5m&#x2F;s&#x2F;s，牵引切断延时 6 秒。线路情况：  试验时为保证安全，要求列车运行时不得超过 1400 米处。  全线要求限速 100 公里每小时；">
<meta property="og:type" content="article">
<meta property="og:title" content="建模优化列车限制速度曲线">
<meta property="og:url" content="https://57d02.cn/2024/09/16/20240916-2/index.html">
<meta property="og:site_name" content="57D02&#39;s Home">
<meta property="og:description" content="建模优化列车限制速度曲线场景假设​	假设列车在一段长 1500 米的试验线上运行。列车运行起点在 60 米处，运行方向沿着里程增加的方向运行。列车数据：列车最大牵引加速度为 1.7m&#x2F;s&#x2F;s，最大制动减速度为 1.5m&#x2F;s&#x2F;s，牵引切断延时 6 秒。线路情况：  试验时为保证安全，要求列车运行时不得超过 1400 米处。  全线要求限速 100 公里每小时；">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://resource-un4.pages.dev/article/%E6%97%A0%E6%A0%87%E9%A2%980.01.webp">
<meta property="article:published_time" content="2024-09-16T12:11:16.000Z">
<meta property="article:modified_time" content="2024-09-17T11:45:28.172Z">
<meta property="article:author" content="57D02">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://resource-un4.pages.dev/article/%E6%97%A0%E6%A0%87%E9%A2%980.01.webp"><link rel="shortcut icon" href="https://resource-un4.pages.dev/yspic/logo.webp"><link rel="canonical" href="https://57d02.cn/2024/09/16/20240916-2/index.html"><link rel="preconnect" href="//cdnjs.cloudflare.com"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdnjs.cloudflare.com/ajax/libs/egjs-infinitegrid/4.11.0/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '建模优化列车限制速度曲线',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-09-17 19:45:28'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="preconnect" href="https://resource-un4.pages.dev" crossorigin><link rel="stylesheet" href="/css/progress_bar.min.css" media="defer" onload="this.media='all'"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://unpkg.zhimg.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.min.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> { preloader.endLoading() })

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><script>window.paceOptions = {
  restartOnPushState: false
}

document.addEventListener('pjax:send', () => {
  Pace.restart()
})
</script><link rel="stylesheet" href="/css/progress_bar.css"/><script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js"></script><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v6.2.0" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly_v4.3.1" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" data-title="本站采用多线部署，主线路托管于Vercel" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Vercel-brightgreen?style=flat&amp;logo=Vercel" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><!-- hexo injector body_end end --></body></html><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://resource-un4.pages.dev/yspic/touxiang.webp" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-cloud"></i><span> 云盘:</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://alist.57d02.cn/"><i class="fa-fw fas fa-cloud"></i><span> 自动选择节点</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://pan.57d02.cn/"><i class="fa-fw fas fa-cloud"></i><span> 大陆</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://111.161.122.206:13132/"><i class="fa-fw fas fa-cloud"></i><span> 备用1</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="http://netdisk.57d02.cn/"><i class="fa-fw fas fa-cloud"></i><span> 台湾</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 更多功能:</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://resource-un4.pages.dev/article/%E6%97%A0%E6%A0%87%E9%A2%980.01.webp')"><nav id="nav"><span id="blog-info"><a href="/" title="57D02's Home"><img class="site-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://resource-un4.pages.dev/article/yjtp.webp"/><span class="site-name">57D02's Home</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-cloud"></i><span> 云盘:</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://alist.57d02.cn/"><i class="fa-fw fas fa-cloud"></i><span> 自动选择节点</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://pan.57d02.cn/"><i class="fa-fw fas fa-cloud"></i><span> 大陆</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://111.161.122.206:13132/"><i class="fa-fw fas fa-cloud"></i><span> 备用1</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="http://netdisk.57d02.cn/"><i class="fa-fw fas fa-cloud"></i><span> 台湾</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 更多功能:</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">建模优化列车限制速度曲线</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-09-16T12:11:16.000Z" title="发表于 2024-09-16 20:11:16">2024-09-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-09-17T11:45:28.172Z" title="更新于 2024-09-17 19:45:28">2024-09-17</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Learn/">Learn</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>16分钟</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="建模优化列车限制速度曲线"><a href="#建模优化列车限制速度曲线" class="headerlink" title="建模优化列车限制速度曲线"></a>建模优化列车限制速度曲线</h2><h4 id="场景假设"><a href="#场景假设" class="headerlink" title="场景假设"></a>场景假设</h4><p>​	假设列车在一段长 1500 米的试验线上运行。列车运行起点在 60 米处，运行方向沿着里程增加的方向运行。<br>列车数据：列车最大牵引加速度为 1.7m&#x2F;s&#x2F;s，最大制动减速度为 1.5m&#x2F;s&#x2F;s，牵引切断延时 6 秒。<br>线路情况：</p>
<ol>
<li><p>试验时为保证安全，要求列车运行时不得超过 1400 米处。</p>
</li>
<li><p>全线要求限速 100 公里每小时；</p>
</li>
<li><p>限速：在 400 米到 450 米之间，要求限速 90 公里每小时；<br> 通过编程计算列车在线路上各点的限制速度（每隔一厘米计算一个速度点）。</p>
<p> ​	简单分析得知要求的结果——列车最高速度的v-s图。这并非求一个连续的曲线，相当于1500米路程上每隔1cm就需要填一个速度值。既然是限制速度，那这些速度值的目标应该使速度最大化。这个问题可以转变成一个运筹优化问题，可以通过建模求解。</p>
</li>
</ol>
<h4 id="模型法"><a href="#模型法" class="headerlink" title="模型法"></a>模型法</h4><p>​	迅速解决且易于拓展。需要调用gurobi。</p>
<p>​	首先定义两个类，环境类（Environment）和列车类(Train)。</p>
<p>​	环境类应该包含总长度（length)，精度(accuracy),全路段最高限速（limitedSpeed），有了这些属性，可以方法函数计算路段上需要多少个平均速度值v和平均加速度值a。再写一个接口存储特殊路段的特殊限速为limitedSection </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Environment</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,length,accuracy,limitedSpeed</span>):</span><br><span class="line">        <span class="comment"># 初始化路段总长度和控制精度</span></span><br><span class="line">        self.length = length</span><br><span class="line">        self.accuracy = accuracy</span><br><span class="line">        self.limitedSpeed = limitedSpeed <span class="comment">#道路的最高限速</span></span><br><span class="line">        self.limitedSection = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getVnumber</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> math.ceil(self.length/self.accuracy)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getAnumber</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.getVnumber()-<span class="number">1</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setLimitedSection</span>(<span class="params">self,a</span>):</span><br><span class="line">        self.limitedSection = a</span><br></pre></td></tr></table></figure>

<p>​	</p>
<p>​	列车类应该包括最高速，最高加减速度，考虑到实际情况预留了无动力（惯性）时加速度和黏着系数等属性。列车在牵引电机功率不变情况下，最高加速度由（牵引力-阻力）&#x2F; 质量得到，牵引力由功率和速度决定，阻力由坡度，摩擦系数等决定。最高减速度由列车车轮黏着系数等参数有关，因此每一时刻的最高加速度和最高减速度都可以通过关于<strong>1.环境因素2.车辆速度因素3.车辆自身属性</strong> 的函数计算出。由于时间原因，模型会简化许多，说这么多只是为了表明这个模型可以在条件充足时模拟真实情况。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Train</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,MaxSpeed,MaxmumAcceleration,MaxmumDeceleration,InertialDeceleration=<span class="number">0</span></span>):</span><br><span class="line">        self.Maxspeed = MaxSpeed</span><br><span class="line">        self.MaxmumAcceleration=MaxmumAcceleration</span><br><span class="line">        self.MaxmumDeceleration=MaxmumDeceleration</span><br><span class="line">        self.InertialAcceleration=InertialDeceleration</span><br><span class="line">        self.delayTime = <span class="number">6</span> <span class="comment"># s</span></span><br><span class="line">        self.adhesion_coefficient = <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">CalculateAdhesionCoefficient</span>(<span class="params">self, env: Environment</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">CaculateMaxAcceleration</span>(<span class="params">self, v, env: Environment</span>):</span><br><span class="line">        CurrentMaxAcceleration = self.MaxmumAcceleration</span><br><span class="line">        <span class="keyword">return</span> CurrentMaxAcceleration</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">CaculateMinAcceleration</span>(<span class="params">self, v, env: Environment</span>):</span><br><span class="line">        CurrentMinAcceleration = self.MaxmumDeceleration</span><br><span class="line">        <span class="keyword">return</span> CurrentMinAcceleration</span><br></pre></td></tr></table></figure>

<p>载入相关参数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">log(<span class="string">&#x27;Initialize the model parameter&#x27;</span>)</span><br><span class="line">Vn = env.getVnumber()</span><br><span class="line">An = env.getAnumber()</span><br><span class="line">accuracy = env.accuracy</span><br><span class="line">delayTime = train.delayTime</span><br></pre></td></tr></table></figure>

<p>定义相关参数，设置优化目标式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Define the speed variables v[i] for i from 1 to Vn</span></span><br><span class="line">v = model.addVars(Vn, lb=<span class="number">0</span>, ub=<span class="built_in">min</span>(env.limitedSpeed,train.Maxspeed), name=<span class="string">&quot;v&quot;</span>)  <span class="comment"># v in m/s, up to min ..</span></span><br><span class="line"><span class="comment"># Define the acceleration variables a[i] for i from 1 to Vn-1</span></span><br><span class="line">a = model.addVars(An, lb=train.MaxmumDeceleration, ub=train.MaxmumAcceleration, name=<span class="string">&quot;a&quot;</span>)  <span class="comment"># a in m/s^2, between -10 and 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the objective to minimize the sum of 1/v[i] (time) but v may be 0. so maximize v[i] could also figure out we need .</span></span><br><span class="line">objective = <span class="built_in">sum</span>(v[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Vn))</span><br><span class="line">model.setObjective(objective, GRB.MAXIMIZE)</span><br></pre></td></tr></table></figure>

<p>为train和envrionment输入参数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">if __name__  == &#x27;__main__&#x27;:</span><br><span class="line">    length = 1500    # m/s 总长</span><br><span class="line">    accuracy = 1      # m 精度</span><br><span class="line">    MaxLimitedSpeed = 100  # km/h 全线限速</span><br><span class="line">    envir=Environment(length, accuracy, MaxLimitedSpeed/3.6)  # km/h-&gt;m/s</span><br><span class="line"></span><br><span class="line">    MaxTrainSpeed = 400  # km/h 列车能够达到的最高速假设为400，但其实只会按照限速行驶</span><br><span class="line">    MaxmumAcceleration = 1.7</span><br><span class="line">    MaxmumDeceleration = -1.5</span><br><span class="line">    train = Train(MaxTrainSpeed / 3.6, MaxmumAcceleration, MaxmumDeceleration)</span><br><span class="line"></span><br><span class="line">    limitedSection = [</span><br><span class="line">        (0,60,0),</span><br><span class="line">        (400,450,90), # (起点,终点,限速km/h)</span><br><span class="line">        (1400,1500,0)</span><br><span class="line">    ]</span><br><span class="line">    envir.setLimitedSection(limitedSection)</span><br></pre></td></tr></table></figure>

<p>绘制的是速度和位移图v-s，根据已知和所需条件可以得出速度v与加速度a关系  <code>v1**2-v2**2=2ax</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Add constraints for the relationship between consecutive speed variables</span><br><span class="line">log(&quot;Add constraints for the relationship between consecutive speed variables&quot;)</span><br><span class="line">for i in range(Vn-1):</span><br><span class="line">    model.addConstr(v[i+1] * v[i+1] - v[i] * v[i] == 2 * a[i] * accuracy, name=f&quot;accel_rel_&#123;i&#125;&quot;)</span><br><span class="line"></span><br><span class="line">model.addConstr(v[0]+v[Vn-1]==0,name=f&quot;start_and_end_speed_limit&quot;)</span><br></pre></td></tr></table></figure>

<p>添加特殊路段限速条件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Add constraints for speed in speed limited section</span></span><br><span class="line">log(<span class="string">&#x27;Add constraints for speed in speed limited section&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> env.limitedSection != <span class="literal">None</span>:</span><br><span class="line">    <span class="comment"># (start point m, end point m, limited maximum speed km/h)</span></span><br><span class="line">    <span class="keyword">for</span> aSection <span class="keyword">in</span> env.limitedSection:</span><br><span class="line">        Start = (<span class="built_in">int</span>)(aSection[<span class="number">0</span>]/accuracy)</span><br><span class="line">        End = math.ceil(aSection[<span class="number">1</span>]/accuracy)</span><br><span class="line">        Speed = aSection[<span class="number">2</span>]/<span class="number">3.6</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Start, End):</span><br><span class="line">            model.addConstr(v[i] &lt;= Speed, name=<span class="string">f&quot;speed_limit_<span class="subst">&#123;Start&#125;</span>_to_<span class="subst">&#123;End&#125;</span>_<span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>此时可以得到简单约束下优化图</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://resource-un4.pages.dev/article/%E5%9B%BE%E7%89%87-1.webp" alt="图片-1"></p>
<p>定义加速度a约束</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># Add constraints for acceleration and deceleration</span><br><span class="line">model.addConstrs((a[i] &lt;= train.CaculateMaxAcceleration(v[i],train) for i in range(An)), name=&quot;a_less_than_max_current_a&quot;)</span><br><span class="line">model.addConstrs((a[i] &gt;= train.CaculateMinAcceleration(v[i],train) for i in range(An)), name=&quot;a_more_than_max_current_a&quot;)</span><br></pre></td></tr></table></figure>

<p>这里调用的约束本该通过环境属性（坡度，摩擦率等），车辆属性（电机牵引力，车轮相关约束），速度（虽然也属于车辆属性，但这是要求的未知量，故单独表示），现使用牵引切断延迟代替。</p>
<p>​	牵引切断就是说加速度从最高1.7m&#x2F;s变化到0需要花费6s，因此得到一个平均加速度导数a’&#x3D;1.7&#x2F;6&#x3D;0.283,a’*t &#x3D; a</p>
<p>​	本想类似  <code>v1**2-v2**2=2ax</code>得到<code>a2**2-a1**2=2a&#39;v</code>(a * t&#x3D;v,v * t&#x3D;x—&gt;a’ * t&#x3D; a, a*t &#x3D; v)来进行约束，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for i in range(An-1):</span><br><span class="line">    model.addConstr((a[i] &gt;= train.CaculateMinAcceleration(v[i], envir)),name=f&quot;a_more_than_max_current_a&#123;i&#125;&quot;)</span><br><span class="line">    model.addConstr((a[i+1]*a[i+1]-a[i]*a[i] &lt;= 2*1.7/6*v[i+1]), name=f&quot;a_less_than_max_current_a_&#123;i&#125;&quot;)</span><br></pre></td></tr></table></figure>

<p>​	乍一看没毛病，但约束出来得到的曲线直接变成一条0直线。发现还是太天真了，<code>a2**2-a1**2=2a&#39;v</code>等式左右两边的标量都不相等。如果想找出加速度导数和前后加速度，速度之间的关系还需要更细致的推导。</p>
<p>​	为了对加速度的变化进行约束，可以引入 <strong>加加速度（jerk）</strong> 的概念，即加速度的变化率。以下是如何实现这种约束的思路：</p>
<ol>
<li><strong>加速度变化的约束</strong></li>
</ol>
<p>可以引入一个新的变量 ( j[i] ) 表示加加速度，并对每段的加速度变化进行约束。假设你希望加速度在相邻段之间是线性变化的，约束可以写为：</p>
<p>$$<br>a[i+1] - a[i] &#x3D; j[i] * \Delta t<br>$$<br>其中，( j[i] ) 是第 ( i ) 段的加加速度，( \Delta t ) 是第 ( i ) 段上的时间。已经有了平均速度 ( v[i] )，所以第 ( i ) 段的时间 ( \Delta t ) 可以通过位移 ( \Delta x &#x3D; 0.01 ) 和速度 ( v[i] ) 计算出来：</p>
<p>$$<br>\Delta t[i] &#x3D; \frac{0.01}{v[i]}<br>$$<br>因此，加速度的变化可以表达为：<br>$$<br>a[i+1] - a[i] &#x3D; j[i] * \frac{0.01}{v[i]}<br>$$<br>这就是加速度的变化率约束。</p>
<ol start="2">
<li><strong>组合速度与加速度的约束</strong></li>
</ol>
<p>原本有速度和加速度的约束：<br>$$<br>v[i+1]^2 - v[i]^2 &#x3D; 2 * a[i] * 0.01<br>$$<br>现在加上加加速度的约束，可以同时控制速度和加速度的变化。</p>
<ol start="3">
<li><strong>完整约束体系</strong></li>
</ol>
<p>最终，你有以下几个关键约束：</p>
<ul>
<li>速度与加速度的约束：(<br>  $$<br>  v[i+1]^2 - v[i]^2 &#x3D; 2 * a[i] * 0.01<br>  $$</li>
<li>加速度变化的约束：<br>  $$<br>  a[i+1] - a[i] &#x3D; j[i] * \frac{0.01}{v[i]}<br>  $$</li>
</ul>
<p>通过这些约束，你可以控制速度和加速度在每个区间的变化，同时加上加加速度的约束来使得加速度的变化更加平滑或符合某些物理规律。</p>
<ol start="4">
<li><strong>进一步约束</strong></li>
</ol>
<p>如果你希望加加速度 ( j[i] ) 也满足某种物理或优化条件，比如不超过某一极限，可以在优化中加入对 ( j[i] ) 的上限和下限约束：<br>$$<br>|j[i]| \leq j_{\text{max}}<br>$$<br>通过这种方式，能够实现对加速度变化的控制，同时确保整个路径上的运动是合理且可控的。</p>
<p>于是更新代码，新增加加速度变量j与约束</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">j = model.addVars(An-<span class="number">1</span>, lb=-<span class="number">2</span>, ub=<span class="number">2</span>, name=<span class="string">&quot;j&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加加速度的约束 a[i+1] - a[i] = j[i] * dx / v[i]</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(An - <span class="number">1</span>):</span><br><span class="line">    model.addConstr((a[i + <span class="number">1</span>] - a[i])* (v[i]+<span class="number">0.001</span>)== j[i] * env.accuracy , name=<span class="string">f&quot;acceleration_jerk_<span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br><span class="line">j_max = <span class="number">0.283</span>  <span class="comment"># 假设加加速度的最大值</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(An - <span class="number">1</span>):</span><br><span class="line">    model.addConstr(j[i] &lt;= j_max, name=<span class="string">f&quot;jerk_limit_upper_<span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br><span class="line">    model.addConstr(j[i] &gt;= -j_max, name=<span class="string">f&quot;jerk_limit_lower_<span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>这里顺带把制动增加延迟也给加上了，得到图像</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://resource-un4.pages.dev/article/%E6%97%A0%E6%A0%87%E9%A2%98.webp" alt="2"></p>
<p>至此，模型法优化结束。</p>
<p>虽然结果精度不错，但是效率并不高。在1500m精度为1m时，进行优化求解耗时达到了83.390s.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> 0.004   Initialize the model parameter</span><br><span class="line"> 0.023   Add constraints for the relationship between consecutive speed variables</span><br><span class="line"> 0.174   Add constraints for speed in speed limited section</span><br><span class="line"> 0.174   Start optimizing model</span><br><span class="line">83.390   Optimization was successful.</span><br></pre></td></tr></table></figure>

<p>注意，这个耗时还仅仅是精度为1m规模下的耗时，比我们需要的0.01m精度规模少了整整两个数量级。</p>
<p>直接将精度调整为0.01m后运行，风扇狂转1小时候，内存爆了：</p>
<pre><code> 0.003   nowtime:2024-09-17 02:12:17.389010
 0.003   Initialize the model parameter
 1.440   Add constraints for the relationship between consecutive speed variables
14.862   Add constraints for speed in speed limited section
14.994   Start optimizing model
    model.optimize(mycallback)
 File &quot;src\\gurobipy\\model.pxi&quot;, line 890, in gurobipy.Model.optimize
gurobipy.GurobiError: Out of memory
</code></pre>
<p>因此在正式进行优化求解前，需要调整代码提高性能。先在1m精度下调整代码。</p>
<p><strong>首先通过调整启发式算法比重调整。</strong></p>
<p>通过日志分析注意到，模型求解耗时高。为了优化求解效率，我增大求解器使用启发式算法（这会也许降低求解的精度）的比重至0.5</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> 0.004   Initialize the model parameter</span><br><span class="line"> 0.019   Add constraints for the relationship between consecutive speed variables</span><br><span class="line"> 0.146   Add constraints for speed in speed limited section</span><br><span class="line"> 0.148   Start optimizing model</span><br><span class="line">65.186   Optimization was successful.</span><br></pre></td></tr></table></figure>

<p>同时比较两组结果方差</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">if DEBUG:</span><br><span class="line">    v = opt(envir, train , 0.05)</span><br><span class="line">    np.save(&#x27;v0.05.npy&#x27;, v)</span><br><span class="line">    v = opt(envir, train , 0.5)</span><br><span class="line">    np.save(&#x27;v0.5.npy&#x27;, v)</span><br><span class="line">    loaded_array = np.load(&#x27;v0.5.npy&#x27;)</span><br><span class="line">    v1 = loaded_array.tolist()</span><br><span class="line">    loaded_array = np.load(&#x27;v0.05.npy&#x27;)</span><br><span class="line">    v2 = loaded_array.tolist()</span><br><span class="line">    # 将两个列表按位置对应相减</span><br><span class="line">    differences = np.array(v1) - np.array(v2)</span><br><span class="line">    # 计算差值列表的方差</span><br><span class="line">    variance = np.var(differences)</span><br><span class="line">    log(variance)</span><br></pre></td></tr></table></figure>

<p>结果您猜怎么着，两组一模一样！方差为0。但后者得到了约22%的效率提升！</p>
<p>但将模式调整为1，即完全使用启发式算法时，求解的速度反而下降了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> 0.005   Initialize the model parameter</span><br><span class="line"> 0.018   Add constraints for the relationship between consecutive speed variables</span><br><span class="line"> 0.144   Add constraints for speed in speed limited section</span><br><span class="line"> 0.146   Start optimizing model</span><br><span class="line">91.833   Optimization was successful.</span><br></pre></td></tr></table></figure>

<p>然后我希望通过设置完全禁用启发式算法来作为效率比较的基准值。但是我的R9000P狂转了十分钟后依旧没能解出结果。。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  0.004   Initialize the model parameter</span><br><span class="line">  0.018   Add constraints for the relationship between consecutive speed variables</span><br><span class="line">  0.147   Add constraints for speed in speed limited section</span><br><span class="line">  0.148   Start optimizing model</span><br><span class="line">634.241   Optimization was not successful.</span><br></pre></td></tr></table></figure>

<p>以gurobi默认启发算法比例0.05作为基准（就最开始耗时83.390s那组），分别测试了0.2，0.5，0.7，1.0</p>
<h5 id="0-05100"><a href="#0-05100" class="headerlink" title="0.05	100%"></a>0.05	100%</h5><h5 id="0-2092-3"><a href="#0-2092-3" class="headerlink" title="0.20	92.3%"></a>0.20	92.3%</h5><h5 id="0-4084"><a href="#0-4084" class="headerlink" title="0.40	84%"></a>0.40	84%</h5><h5 id="0-5077-6"><a href="#0-5077-6" class="headerlink" title="0.50	77.6%"></a>0.50	77.6%</h5><h5 id="0-7098-8"><a href="#0-7098-8" class="headerlink" title="0.70	98.8%"></a>0.70	98.8%</h5><h5 id="1-00109-4"><a href="#1-00109-4" class="headerlink" title="1.00	109.4%"></a>1.00	109.4%</h5><p>最终选定使用0.5作为启发式比重。</p>
<p>但这对于多两个数量级的规模而言还是不足，因此我们需要第二项优化：</p>
<p><strong>使用小规模优化结果生成大规模问题的初始解</strong></p>
<p>gurobi允许我们提供初始解，如果这个初始解足够好能够极大的提高求解效率。虽然理论上是这样，但是在我尝试先用numpy保存求解器运行的解，再次运行时调用这个解作为初始解时，他反而需要花更长的时间求解。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">   Nodes    |    Current Node    |     Objective Bounds      |     Work</span><br><span class="line">Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time</span><br></pre></td></tr></table></figure>

<p>加载初始解同时禁用预求解时</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">134   102 32125.5236   10 1537 31965.0270 32402.9058  1.37%   196   15s</span><br><span class="line">1997   814 32184.6199   53 1414 31965.0270 32324.1290  1.12%   182   60s</span><br></pre></td></tr></table></figure>

<p>加载初始解但是不禁预求解时</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">170    99 31972.1429   10 1229 31965.0270 32382.6278  1.31%   203   15s</span><br><span class="line">850   395 32182.2896   18    0 31965.0270 32327.4521  1.13%   169   60s</span><br></pre></td></tr></table></figure>

<p>不加载初始解也不禁预求解</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">721   336     cutoff   11      31965.0270 32368.6772  1.26%   178   15s</span><br><span class="line">2809   842 32071.3195   38 2041 31965.0270 32294.7055  1.03%   165   60s</span><br></pre></td></tr></table></figure>

<p>将日志提取分析后发现问题所在：设置了初始解确实能够快速定位到一个很好的解，但是我们设置求解器输出最优解是在gap小于1%人为他是最优解。而实际上的最优解早在15s之前就已经确认出来了(<code>Incumbent</code>),剩下的时间其实是求解器在求解成本下界，当下界与当前最优值差距小于1%才输出，这就导致了我们将上一次求解出的最优解（就算它真的是完全精确的最优解）带入初始解时，求解器也需要花费巨大的资源去提高下界来验证确确实实没有比这个更好的解来证明这个解是最优解。也就是说当问题规模特别大时，gap其实并不是一个很好的指标。至于耗时增加，则是因为我们提供的初始解并不是优化下届的好路线。预求解得到的解是优化下届的好的起点，因此预求解越多，求解速度越快，但其实在十五秒时停止优化最优解和最终得出的最优解是一模一样的。因此我后续将采用TimeLimit和NodeLimit双重限制来作为求解结束标志。</p>
<p>在0.01m规模求解中，光预处理就花费很长时间</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Presolve time: 128.77s</span><br><span class="line">Barrier statistics:</span><br><span class="line"> AA&#x27; NZ     : 9.782e+06</span><br><span class="line"> Factor NZ  : 1.839e+07 (roughly 1.1 GB of memory)</span><br><span class="line"> Factor Ops : 2.312e+08 (less than 1 second per iteration)</span><br><span class="line"> Threads    : 1</span><br></pre></td></tr></table></figure>

<p>但实际上我们使用1m精度下的解处理成0.01m精度下的初始解后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">log(&quot;trying loading initsolution&quot;)</span><br><span class="line">loaded_array = np.load(&#x27;v.npy&#x27;)</span><br><span class="line">init_solution = loaded_array.tolist()</span><br><span class="line">fix_init_solutions = list(np.zeros(Vn))</span><br><span class="line">for i in range(Vn):</span><br><span class="line">    fix_init_solutions[i] = init_solution[int(i*accuracy/1)]</span><br><span class="line">    v[i].start = fix_init_solutions[i]</span><br></pre></td></tr></table></figure>

<p>直接将这个初始解输出为得到图像</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://resource-un4.pages.dev/article/%E6%97%A0%E6%A0%87%E9%A2%980.01.webp" alt="无标题0.01"></p>
<p>看起来就很像最优解了，因此可以在指定时间内求解后没能到达1%gap就输出当前最优解。实际上处理了10分钟后可得初始解与最优解差距在9.1585%以内。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Best objective 3.199205126616e+06, best bound 3.492205214175e+06, gap 9.1585%</span><br></pre></td></tr></table></figure>

<p>但仔细想想，求解规模1500*100&#x3D;150000个目标参数，同时不仅有149999个加速度a限制，149998个加加速度j限制，而且限制的约束关系式还是非线性的（平方），因此不如直接在小规模的基础上通过人工优化得到大规模的结果（因为我感觉也没差了）</p>
<p>但如果按照上面的方式处理初始解会出现并不平滑</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://resource-un4.pages.dev/article/acaacc131315.webp" alt="acaacc131315"></p>
<p>因此改进处理方式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">loaded_array = np.load(&#x27;v.npy&#x27;)</span><br><span class="line">            init_solution = loaded_array.tolist()</span><br><span class="line">            fix_init_solutions = list(np.zeros(Vn))</span><br><span class="line">            for i in range(Vn):</span><br><span class="line">                if int(i*accuracy/1)+1 &lt;= len(init_solution)-1:</span><br><span class="line">                    fix_init_solutions[i] = init_solution[int(i*accuracy/1)] + (init_solution[int(i*accuracy/1)+1]-init_solution[int(i*accuracy/1)])*accuracy*(i-int(i*accuracy/1)/accuracy)</span><br><span class="line">                else:</span><br><span class="line">                    fix_init_solutions[i] = init_solution[int(i * accuracy / 1)]</span><br></pre></td></tr></table></figure>

<p>并且不在对此进行求解优化，直接作为输出，最终得到一个平滑结果曲线。</p>
<p>至此，结束。</p>
<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://57d02.cn">57D02</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://57d02.cn/2024/09/16/20240916-2/">https://57d02.cn/2024/09/16/20240916-2/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://57d02.cn" target="_blank">57D02's Home</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://resource-un4.pages.dev/article/%E6%97%A0%E6%A0%87%E9%A2%980.01.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/butterfly-extsrc/1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdnjs.cloudflare.com/ajax/libs/butterfly-extsrc/1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/09/23/20240923/" title="时间管理大师(一)"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://resource-un4.pages.dev/yspic/background.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">时间管理大师(一)</div></div></a></div><div class="next-post pull-right"><a href="/2024/09/16/20240916/" title="agent学习(1)"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://resource-un4.pages.dev/article/output_max_compressed.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">agent学习(1)</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://resource-un4.pages.dev/yspic/touxiang.webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">57D02</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/57Darling02"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/57Darling02" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:57d02@57d02.cn" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://space.bilibili.com/208208313" target="_blank" title=""><i class="fab fa-bilibili"></i></a><a class="social-icon" href="https://alist.57d02.cn/" target="_blank" title=""><i class="fas fa-cloud"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">ok，fine，nobody know this blog but you .That's mean that you are my best frined!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BB%BA%E6%A8%A1%E4%BC%98%E5%8C%96%E5%88%97%E8%BD%A6%E9%99%90%E5%88%B6%E9%80%9F%E5%BA%A6%E6%9B%B2%E7%BA%BF"><span class="toc-number">1.</span> <span class="toc-text">建模优化列车限制速度曲线</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%BA%E6%99%AF%E5%81%87%E8%AE%BE"><span class="toc-number">1.0.1.</span> <span class="toc-text">场景假设</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E6%B3%95"><span class="toc-number">1.0.2.</span> <span class="toc-text">模型法</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#0-05100"><span class="toc-number">1.0.2.1.</span> <span class="toc-text">0.05	100%</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#0-2092-3"><span class="toc-number">1.0.2.2.</span> <span class="toc-text">0.20	92.3%</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#0-4084"><span class="toc-number">1.0.2.3.</span> <span class="toc-text">0.40	84%</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#0-5077-6"><span class="toc-number">1.0.2.4.</span> <span class="toc-text">0.50	77.6%</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#0-7098-8"><span class="toc-number">1.0.2.5.</span> <span class="toc-text">0.70	98.8%</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-00109-4"><span class="toc-number">1.0.2.6.</span> <span class="toc-text">1.00	109.4%</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/09/23/Searchmethod/" title="Searchmethod"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://resource-un4.pages.dev/yspic/bg2.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Searchmethod"/></a><div class="content"><a class="title" href="/2024/09/23/Searchmethod/" title="Searchmethod">Searchmethod</a><time datetime="2024-09-23T13:12:48.000Z" title="发表于 2024-09-23 21:12:48">2024-09-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/23/20240923/" title="时间管理大师(一)"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://resource-un4.pages.dev/yspic/background.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="时间管理大师(一)"/></a><div class="content"><a class="title" href="/2024/09/23/20240923/" title="时间管理大师(一)">时间管理大师(一)</a><time datetime="2024-09-23T10:48:30.000Z" title="发表于 2024-09-23 18:48:30">2024-09-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/16/20240916-2/" title="建模优化列车限制速度曲线"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://resource-un4.pages.dev/article/%E6%97%A0%E6%A0%87%E9%A2%980.01.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="建模优化列车限制速度曲线"/></a><div class="content"><a class="title" href="/2024/09/16/20240916-2/" title="建模优化列车限制速度曲线">建模优化列车限制速度曲线</a><time datetime="2024-09-16T12:11:16.000Z" title="发表于 2024-09-16 20:11:16">2024-09-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/16/20240916/" title="agent学习(1)"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://resource-un4.pages.dev/article/output_max_compressed.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="agent学习(1)"/></a><div class="content"><a class="title" href="/2024/09/16/20240916/" title="agent学习(1)">agent学习(1)</a><time datetime="2024-09-16T09:56:35.000Z" title="发表于 2024-09-16 17:56:35">2024-09-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/05/10/columngeneration/" title="columngeneration 列生成算法"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://resource-un4.pages.dev/yspic/Marx&amp;Engels.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="columngeneration 列生成算法"/></a><div class="content"><a class="title" href="/2024/05/10/columngeneration/" title="columngeneration 列生成算法">columngeneration 列生成算法</a><time datetime="2024-05-10T15:07:59.000Z" title="发表于 2024-05-10 23:07:59">2024-05-10</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 By 57D02</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i><span id="percent">0</span><span>%</span></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/vanilla-lazyload/17.3.1/lazyload.iife.min.js"></script><div class="js-pjax"></div><script async src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script async src="//at.alicdn.com/t/font_2264842_b004iy0kk2b.js"></script><script defer data-pjax src="/js/readPercent.js"></script><script async data-pjax src="/js/anzhiyu.js"></script><script async data-pjax src="/js/anzhiyufunction.js"></script><script async src="/js/anzhiyuOnlyOne.js"></script><script async src="/js/title.js"></script><script async src="js/APlayer.min.js"></script><script async src="js/Meting.min.js"></script><div class="aplayer no-destroy" data-id="8708496825" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="false" data-mini="true"> </div><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aplayer/1.10.1/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdnjs.cloudflare.com/ajax/libs/aplayer/1.10.1/APlayer.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/butterfly-extsrc/1.1.3/metingjs/dist/Meting.min.js"></script><script src="https://lib.baomitu.com/pjax/0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show","#web_bg",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener
  btf.removeGlobalFnEvent('pjax')
  btf.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script></div>